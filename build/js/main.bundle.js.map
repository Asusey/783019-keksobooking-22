{"version":3,"sources":["webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/popup.js","webpack://keksobooking/./source/js/card.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/upload.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/validation.js","webpack://keksobooking/./source/js/form.js","webpack://keksobooking/./source/js/disabled.js","webpack://keksobooking/./source/js/api.js"],"names":["showAlert","message","alertContainer","document","createElement","style","zIndex","position","left","top","right","padding","fontSize","textAlign","backgroundColor","textContent","body","append","setTimeout","remove","isEscEvent","evt","key","successfulCreationTemplate","querySelector","content","errorCreationTemplate","MAIN","successfulCreation","cloneNode","errorCreation","closePopup","removeEventListener","closePoupHandler","closePoupByKeyHandler","preventDefault","closeErrorPopup","closeErrorPopupHandler","closeErrorPoupByKeyHandler","announcementCardTemplate","typeMapper","flat","bungalow","house","palace","LAT","LNG","map","ads","mainPinIcon","window","L","icon","iconUrl","iconSize","iconAnchor","mainPinMarker","marker","lat","lng","draggable","addPins","data","cards","forEach","card","cardElement","offer","title","address","price","type","rooms","guests","checkin","checkout","features","featuresList","featuresContainer","createDocumentFragment","feature","featureElement","classList","add","appendChild","createFeatures","innerHTML","description","photos","photosList","template","photosContainer","search","photoElement","src","createPhotos","author","avatar","push","createCards","obj","i","ordinaryPinIcon","location","adPin","addTo","bindPopup","resetPins","removePins","slice","eachLayer","layer","options","FILE_TYPES","FILE_CHOOSER_AVATAR","avatarPreviewWrapper","AVATAR_PREVIEW","FILE_CHOOSER_PHOTOS","PHOTOS_CONTAINER","PHOTO","addEventListener","file","files","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","result","readAsDataURL","chosenFiles","Array","from","currentFile","newPhoto","photoNew","alt","width","height","resetImage","querySelectorAll","imgContainer","children","MAP_FILTERS","HOUSING_TYPE","HOUSING_PRICE","HOUSING_ROOMS","HOUSING_GUESTS","FILTER_CHECKBOX","resetFilterForm","reset","FORM","TITLE_INPUT","PRICE_INPUT","ROOM_NUMBER_SELECT","CAPACITY_SELECT","FORM_FIELDS","elements","CAPACITY_ELEMENTS","roomCapacityMap","1","2","3","100","allFormFields","field","target","border","HOUSE_TYPE","PRICE","ADDRESS","FORM_ELEMENT_TIME","CHECKIN","CHECKOUT","RESET_BUTTON","minPrice","placeholder","value","setAttribute","onClearForm","setLatLng","MAP_FILTERS_ELEMENTS","MAP_FILTERS_INPUT","FORM_HEADER","FORM_ELEMENTS","toggleDisable","state","element","disabled","onSuccessSubmit","onFail","valueLength","length","setCustomValidity","reportValidity","capacity","option","includes","removeAttribute","houseType","checkPrice","fetch","method","then","response","ok","catch","sendData","FormData","on","selected","setView","tileLayer","attribution","getLatLng","toFixed","onSuccess","onError","json","getData","_","debounce","filter","filteredAds","ad","onFilterPins","validateType","validatePrice","toString","validateRooms","validateGuests","checked","every","valedateFeatures"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const ALERT_SHOW_TIME = 5000;\n\n//возвращает случайное целое число из переданного диапазона включительно\nconst getRundomInteger = (min, max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\n//возвращает случайный элемент из массива\nconst getRandomElement = (array) => {\n  const randomIndex = getRundomInteger(0, array.length - 1);\n  return array[randomIndex];\n};\n\n//возвращает случайное число с плавающей точкой из переданного диапазона включительно\nfunction getGeographicCoordinates(min, max, numberOfDecimals) {\n  const numRandom = Math.random() * (max - min + 1) + min;\n  return numRandom.toFixed(numberOfDecimals);\n}\n\n//создает массив случайной длины из значений\nconst getRandomLengthArray = (array) => {\n  const randomLengthArray = array.slice(\n    0,\n    getRundomInteger(0, array.length - 1),\n  );\n\n  return randomLengthArray;\n};\n\nconst showAlert = (message) => {\n  const alertContainer = document.createElement('div');\n  alertContainer.style.zIndex = 100;\n  alertContainer.style.position = 'absolute';\n  alertContainer.style.left = 0;\n  alertContainer.style.top = 0;\n  alertContainer.style.right = 0;\n  alertContainer.style.padding = '10px 3px';\n  alertContainer.style.fontSize = '30px';\n  alertContainer.style.textAlign = 'center';\n  alertContainer.style.backgroundColor = 'red';\n\n  alertContainer.textContent = message;\n\n  document.body.append(alertContainer);\n\n  setTimeout(() => {\n    alertContainer.remove();\n  }, ALERT_SHOW_TIME);\n};\n\nconst isEscEvent = (evt) => {\n  return evt.key === 'Escape' || evt.key === 'Esc';\n};\n\nexport {\n  getRundomInteger,\n  getRandomElement,\n  getGeographicCoordinates,\n  getRandomLengthArray,\n  showAlert,\n  isEscEvent\n};\n","import { isEscEvent } from './util.js';\n\nconst successfulCreationTemplate = document\n  .querySelector('#success')\n  .content.querySelector('.success');\nconst errorCreationTemplate = document\n  .querySelector('#error')\n  .content.querySelector('.error');\nconst MAIN = document.querySelector('main');\nconst successfulCreation = successfulCreationTemplate.cloneNode(true);\nconst errorCreation = errorCreationTemplate.cloneNode(true);\n\n// удаление попапа об успешном создании объявления\nconst closePopup = () => {\n  successfulCreation.remove();\n  document.removeEventListener('click', closePoupHandler);\n  document.removeEventListener('keydown', closePoupByKeyHandler);\n};\n\nconst closePoupHandler = (evt) => {\n  evt.preventDefault();\n  closePopup();\n};\n\nconst closePoupByKeyHandler = (evt) => {\n  if (isEscEvent(evt)) {\n    evt.preventDefault();\n    closePopup();\n  }\n};\n\n//успешное создание объявления\nconst createSuccessfulCreation = () => {\n  MAIN.appendChild(successfulCreation);\n\n  document.addEventListener('click', closePoupHandler);\n  document.addEventListener('keydown', closePoupByKeyHandler);\n};\n\n//удаление попапа об ошибке создания объявления\nconst closeErrorPopup = () => {\n  errorCreation.remove();\n  document.removeEventListener('click', closeErrorPopupHandler);\n  document.removeEventListener('keydown', closeErrorPoupByKeyHandler);\n};\n\nconst closeErrorPopupHandler = (evt) => {\n  evt.preventDefault();\n  closeErrorPopup();\n};\n\nconst closeErrorPoupByKeyHandler = (evt) => {\n  if (isEscEvent(evt)) {\n    evt.preventDefault();\n    closeErrorPopup();\n  }\n};\n\n//ошибка создания объявления\nconst createErrorCreation = () => {\n  MAIN.appendChild(errorCreation);\n\n  document.addEventListener('click', closeErrorPopupHandler);\n  document.addEventListener('keydown', closeErrorPoupByKeyHandler);\n};\n\nexport { createSuccessfulCreation, createErrorCreation };\n","const announcementCardTemplate = document\n  .querySelector('#card')\n  .content.querySelector('.popup');\nconst typeMapper = {\n  flat: 'Квартира',\n  bungalow: 'Бунгало',\n  house: 'Дом',\n  palace: 'Дворец',\n};\n\n//создаем список преимуществ\nconst createFeatures = (featuresList) => {\n  const featuresContainer = document.createDocumentFragment();\n\n  featuresList.forEach((feature) => {\n    const featureElement = document.createElement('li');\n    featureElement.classList.add(\n      'popup__feature',\n      `popup__feature--${feature}`,\n    );\n    featuresContainer.appendChild(featureElement);\n  });\n  return featuresContainer;\n};\n\n//создаем список фотографий\nconst createPhotos = (photosList, template) => {\n  const photosContainer = document.createDocumentFragment();\n\n  photosList.forEach((search) => {\n    const photoElement = template.cloneNode(true);\n    photoElement.src = search;\n    photosContainer.appendChild(photoElement);\n  });\n  return photosContainer;\n};\n\nconst createCards = (data) => {\n  const cards = [];\n\n  data.forEach((card) => {\n    const cardElement = announcementCardTemplate.cloneNode(true);\n\n    cardElement.querySelector('.popup__title').textContent = card.offer.title;\n    cardElement.querySelector('.popup__text--address').textContent =\n      card.offer.address;\n    cardElement.querySelector('.popup__text--price').textContent =\n      card.offer.price + ' ₽/ночь';\n    cardElement.querySelector('.popup__type').textContent =\n      typeMapper[card.offer.type];\n    cardElement.querySelector('.popup__text--capacity').textContent =\n      card.offer.rooms + ' комнаты для ' + card.offer.guests + ' гостей';\n    cardElement.querySelector('.popup__text--time').textContent =\n      'Заезд после ' + card.offer.checkin + ', выезд до ' + card.offer.checkout;\n    //.popup__feature\n    const features = createFeatures(\n      card.offer.features,\n      cardElement.querySelector('.popup__feature'),\n    );\n    cardElement.querySelector('.popup__features').innerHTML = '';\n    cardElement.querySelector('.popup__features').appendChild(features);\n\n    cardElement.querySelector('.popup__description').textContent =\n      card.offer.description;\n    //.popup__photos\n    const photos = createPhotos(\n      card.offer.photos,\n      cardElement.querySelector('.popup__photo'),\n    );\n    cardElement.querySelector('.popup__photos').innerHTML = '';\n    cardElement.querySelector('.popup__photos').appendChild(photos);\n\n    cardElement.querySelector('.popup__avatar').src = card.author.avatar;\n    cards.push(cardElement);\n  });\n  return cards;\n};\n\nexport { createCards };\n","import { setFormActive } from './disabled.js';\nimport { ADDRESS } from './form.js';\nimport { createCards } from './card.js';\nimport { getData } from './api.js';\nimport { showAlert } from './util.js';\n\nconst LAT = 35.6895;\nconst LNG = 139.69171;\nconst ZOOM = 10;\nconst MAX_NUMBER_OF_ADS = 10;\n\nlet map = null;\nlet ads = [];\n\n//главный маркер\nconst mainPinIcon = window.L.icon({\n  iconUrl: './img/main-pin.svg',\n  iconSize: [52, 52],\n  iconAnchor: [26, 52],\n});\n\nconst mainPinMarker = window.L.marker(\n  {\n    lat: LAT,\n    lng: LNG,\n  },\n  {\n    draggable: true,\n    icon: mainPinIcon,\n  },\n);\n\n//'обычные' маркеры\nconst addPins = (data) => {\n  const cards = createCards(data);\n  data.forEach((obj, i) => {\n    const ordinaryPinIcon = window.L.icon({\n      iconUrl: './img/pin.svg',\n      iconSize: [40, 40],\n      iconAnchor: [20, 40],\n    });\n\n    const ordinaryPinMarker = window.L.marker(\n      {\n        lat: obj.location.lat,\n        lng: obj.location.lng,\n      },\n      {\n        draggable: false,\n        icon: ordinaryPinIcon,\n        adPin: true,\n      },\n    );\n\n    ordinaryPinMarker.addTo(map).bindPopup(cards[i]);\n  });\n};\n\nconst resetPins = () => {\n  removePins();\n  addPins(ads.slice(0, MAX_NUMBER_OF_ADS));\n}\n\nconst initMap = () => {\n  //создаём и отрисовываем карту\n  map = window.L.map('map-canvas')\n    .on('load', () => {\n      setFormActive();\n      ADDRESS.value = `${LAT}, ${LNG}`;\n    })\n    .setView(\n      {\n        lat: LAT,\n        lng: LNG,\n      },\n      ZOOM,\n    );\n\n  window.L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n    attribution:\n      '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  }).addTo(map);\n\n  mainPinMarker.addTo(map);\n\n  mainPinMarker.on('moveend', (evt) => {\n    //записываем координаты после перемещения метки в строку адреса\n    ADDRESS.value = `${evt.target\n      .getLatLng()\n      .lat.toFixed(5)}, ${evt.target.getLatLng().lng.toFixed(5)}`;\n  });\n\n  getData(onSuccess, showAlert);\n};\n\nconst removePins = () => {\n  map.eachLayer(layer => {\n    if (layer.options.adPin) {\n      layer.remove()\n    }\n  });\n}\n\nconst onSuccess = (data) => {\n  ads = data;\n  addPins(data.slice(0, MAX_NUMBER_OF_ADS));\n}\n\nconst onFilterPins = (filter) => {\n  removePins();\n\n  const filteredAds = [];\n\n  for (let ad of ads) {\n    if (filter(ad)) {\n      filteredAds.push(ad);\n    }\n    if (filteredAds.length >= MAX_NUMBER_OF_ADS) {\n      break;\n    }\n  }\n\n  addPins(filteredAds);\n}\n\nexport { mainPinMarker, LAT, LNG,  initMap, onFilterPins, resetPins };\n","import { showAlert } from './util.js';\n\nconst FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\nconst DEFAULT_IMG = 'img/muffin-grey.svg';\nconst FILE_CHOOSER_AVATAR = document.querySelector(\n  '.ad-form__field .ad-form-header__input',\n);\nconst avatarPreviewWrapper = document.querySelector('.ad-form-header__preview');\nconst AVATAR_PREVIEW = document.querySelector('.ad-form-header__preview img');\nconst FILE_CHOOSER_PHOTOS = document.querySelector(\n  '.ad-form__upload .ad-form__input',\n);\nconst PHOTOS_CONTAINER = document.querySelector('.ad-form__photo-container');\nconst PHOTO = document.querySelector('.ad-form__photo');\n\nFILE_CHOOSER_AVATAR.addEventListener('change', () => {\n  const file = FILE_CHOOSER_AVATAR.files[0];\n  const fileName = file.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n\n  if (matches) {\n    const reader = new FileReader();\n\n    reader.addEventListener('load', () => {\n      AVATAR_PREVIEW.src = reader.result;\n    });\n\n    reader.readAsDataURL(file);\n  } else {\n    showAlert('Пожалуйста, загрузите фото с расширением .jpeg или .png');\n  }\n});\n\nFILE_CHOOSER_PHOTOS.addEventListener('change', () => {\n  const chosenFiles = FILE_CHOOSER_PHOTOS.files;\n  const allChosenFiles = Array.from(chosenFiles);\n\n  allChosenFiles.forEach((file) => {\n    const currentFile = file;\n    const fileName = currentFile.name.toLowerCase();\n\n    const matches = FILE_TYPES.some((it) => {\n      return fileName.endsWith(it);\n    });\n\n    if (matches) {\n      const reader = new FileReader();\n\n      reader.addEventListener('load', () => {\n        PHOTO.remove();\n\n        const newPhoto = document.createElement('img');\n        const photoNew = document.createElement('div');\n        newPhoto.src = reader.result;\n        newPhoto.alt = 'Фото жилья';\n        newPhoto.width = 70;\n        newPhoto.height = 70;\n        photoNew.classList.add('ad-form__photo');\n        photoNew.appendChild(newPhoto);\n        PHOTOS_CONTAINER.appendChild(photoNew);\n      });\n\n      reader.readAsDataURL(currentFile);\n    }\n  });\n});\n\nconst resetImage = () => {\n  const photos = document.querySelectorAll('.ad-form__photo');\n  photos.forEach((imgContainer, i) => {\n    if (i === 0) {\n      const firstImage = imgContainer.querySelector('img');\n      if (firstImage) {\n        imgContainer.querySelector('img').remove();\n      }\n    } else {\n      imgContainer.remove();\n    }\n  });\n  avatarPreviewWrapper.children[0].src = DEFAULT_IMG;\n};\n\nexport { resetImage };\n","import { onFilterPins } from './map.js';\n\nconst MAP_FILTERS = document.querySelector('.map__filters');\nconst HOUSING_TYPE = MAP_FILTERS.querySelector('#housing-type');\nconst HOUSING_PRICE = MAP_FILTERS.querySelector('#housing-price');\nconst HOUSING_ROOMS = MAP_FILTERS.querySelector('#housing-rooms');\nconst HOUSING_GUESTS = MAP_FILTERS.querySelector('#housing-guests');\nconst FILTER_CHECKBOX = MAP_FILTERS.querySelectorAll('.map__checkbox');\nconst RERENDER_DELAY = 500;\n\nconst validateType = (ad) =>\n  HOUSING_TYPE.value === ad.offer.type || HOUSING_TYPE.value === 'any';\n\nconst validatePrice = (ad) =>\n  (HOUSING_PRICE.value === 'low' && ad.offer.price < 10000) ||\n  (HOUSING_PRICE.value === 'high' && ad.offer.price > 50000) ||\n  (HOUSING_PRICE.value === 'middle' &&\n    ad.offer.price >= 10000 &&\n    ad.offer.price <= 50000) ||\n  HOUSING_PRICE.value === 'any';\n\nconst validateRooms = (ad) =>\n  HOUSING_ROOMS.value === ad.offer.rooms.toString() ||\n  HOUSING_ROOMS.value === 'any';\n\nconst validateGuests = (ad) =>\n  HOUSING_GUESTS.value === ad.offer.guests.toString() ||\n  HOUSING_GUESTS.value === 'any';\n\nconst valedateFeatures = (ad) => {\n  const requestedFeatures = Array.from(FILTER_CHECKBOX).filter(\n    (element) => element.checked,\n  );\n\n  return requestedFeatures.every((element) =>\n    ad.offer.features.includes(element.value),\n  );\n};\n\nconst initFilters = () => {\n  MAP_FILTERS.addEventListener(\n    'change',\n    window._.debounce(() => {\n      onFilterPins(\n        (ad) =>\n          validateType(ad) &&\n          validatePrice(ad) &&\n          validateRooms(ad) &&\n          validateGuests(ad) &&\n          valedateFeatures(ad),\n      );\n    }, RERENDER_DELAY),\n  );\n};\n\nconst resetFilterForm = () => {\n  MAP_FILTERS.reset();\n};\n\nexport { initFilters, resetFilterForm };\n","const FORM = document.querySelector('.ad-form');\nconst TITLE_INPUT = document.querySelector('#title');\nconst MIN_TITLE_LENGTH = 30;\nconst MAX_TITLE_LENGTH = 100;\nconst PRICE_INPUT = FORM.querySelector('#price');\nconst ROOM_NUMBER_SELECT = FORM.querySelector('#room_number');\nconst CAPACITY_SELECT = FORM.querySelector('#capacity');\nconst FORM_FIELDS = FORM.elements;\nconst CAPACITY_ELEMENTS = FORM.querySelectorAll('#capacity option');\n\nconst roomCapacityMap = {\n  1: ['1'],\n  2: ['1', '2'],\n  3: ['1', '2', '3'],\n  100: ['0'],\n};\n\n//добавляем полям элемента capacity неактивное состояние\nconst setCapacitySelectdisabled = () => {\n  CAPACITY_ELEMENTS.forEach((element) => {\n    if (!element.selected) {\n      element.setAttribute('disabled', 'disabled');\n    }\n  });\n};\n\nconst initValidation = () => {\n  //заголовок объявления\n  TITLE_INPUT.addEventListener('input', () => {\n    const valueLength = TITLE_INPUT.value.length;\n\n    if (valueLength < MIN_TITLE_LENGTH) {\n      TITLE_INPUT.setCustomValidity(\n        'Введите ещё ' + (MIN_TITLE_LENGTH - valueLength) + ' симв.',\n      );\n    } else if (valueLength > MAX_TITLE_LENGTH) {\n      TITLE_INPUT.setCustomValidity(\n        'Удалите лишние ' + (valueLength - MAX_TITLE_LENGTH) + ' симв.',\n      );\n    } else {\n      TITLE_INPUT.setCustomValidity('');\n    }\n    TITLE_INPUT.reportValidity();\n  });\n\n  //количество комнат = количество мест\n  ROOM_NUMBER_SELECT.addEventListener('change', (evt) => {\n    const capacity = roomCapacityMap[evt.target.value];\n    const options = CAPACITY_SELECT.querySelectorAll('option');\n\n    //расставляем disabled и selected\n    options.forEach((option) => {\n      if (!capacity.includes(option.value)) {\n        option.setAttribute('disabled', 'disabled');\n      } else {\n        option.removeAttribute('disabled');\n        CAPACITY_SELECT.value = option.value;\n      }\n    });\n  });\n};\n\n//подсветка неверных полей\nconst allFormFields = Array.from(FORM_FIELDS);\n\nconst checkedInvalidFields = () => {\n  allFormFields.forEach((field) => {\n    field.addEventListener('invalid', (evt) => {\n      evt.target.style.border = 'solid 3px red';\n    });\n    field.addEventListener('input', (evt) => {\n      evt.target.style.border = 'none';\n    });\n  });\n};\n\ncheckedInvalidFields();\n\n//очистка подсветки неверных полей\nconst resetInvalidFields = () => {\n  allFormFields.forEach((field) => {\n    field.style.border = 'none';\n  });\n};\n\nexport {\n  initValidation,\n  setCapacitySelectdisabled,\n  PRICE_INPUT,\n  resetInvalidFields\n};\n","import { sendData } from './api.js';\nimport { createSuccessfulCreation, createErrorCreation } from './popup.js';\nimport { mainPinMarker, LAT, LNG, resetPins } from './map.js';\nimport { resetImage } from './upload.js';\nimport { resetFilterForm } from './filter.js';\nimport { PRICE_INPUT, resetInvalidFields } from './validation.js';\n\nconst FORM = document.querySelector('.ad-form');\nconst HOUSE_TYPE = FORM.querySelector('#type');\nconst PRICE = FORM.querySelector('#price');\nconst ADDRESS = FORM.querySelector('#address');\nconst FORM_ELEMENT_TIME = FORM.querySelector('.ad-form__element--time');\nconst CHECKIN = FORM.querySelector('#timein');\nconst CHECKOUT = FORM.querySelector('#timeout');\nconst RESET_BUTTON = FORM.querySelector('.ad-form__reset');\n\nconst minPrice = {\n  bungalow: 0,\n  flat: 1000,\n  house: 5000,\n  palace: 10000,\n};\n\n// проверяем цену при отправке формы\nconst checkPrice = () => {\n  const price = PRICE.value;\n  const houseType = HOUSE_TYPE.value;\n  if (minPrice[houseType] < price) {\n    PRICE_INPUT.setCustomValidity('Поле, обязательное для заполнения');\n    return false;\n  }\n\n  PRICE_INPUT.setCustomValidity('');\n  return true;\n}\n\nHOUSE_TYPE.addEventListener('change', (evt) => {\n  PRICE.placeholder = minPrice[evt.target.value];\n  PRICE.setAttribute('min', minPrice[evt.target.value]);\n});\n\nFORM_ELEMENT_TIME.addEventListener('change', (evt) => {\n  CHECKOUT.value = evt.target.value;\n  CHECKIN.value = evt.target.value;\n});\n\n//очистка формы\nconst onClearForm = () => {\n  FORM.reset();\n  resetImage();\n  resetFilterForm();\n  resetPins();\n  resetInvalidFields();\n  PRICE.placeholder = minPrice.flat;\n\n  mainPinMarker.setLatLng({\n    lat: LAT,\n    lng: LNG,\n  });\n\n  ADDRESS.value = `${LAT}, ${LNG}`;\n};\n\n//отменяет действие формы по умолчанию, отправляет данные на сервер\nconst setUserFormSubmit = (onSuccessSubmit, onFail) => {\n  FORM.addEventListener('submit', (evt) => {\n    evt.preventDefault();\n\n    //проверяем цену при отправке формы\n    if (!checkPrice()) {\n      return;\n    }\n\n    sendData(\n      () => {\n        onSuccessSubmit();\n        onClearForm();\n      },\n      () => onFail(),\n      new FormData(evt.target),\n    );\n  });\n};\n\n//кнопка очистить форму\nRESET_BUTTON.addEventListener('click', (evt) => {\n  evt.preventDefault();\n  onClearForm();\n  resetImage();\n  resetFilterForm();\n  resetPins();\n});\n\nconst initFormSubmit = () => {\n  setUserFormSubmit(createSuccessfulCreation, createErrorCreation);\n};\n\nexport { FORM, ADDRESS, initFormSubmit };\n","import { FORM, ADDRESS } from './form.js';\nimport { setCapacitySelectdisabled } from './validation.js';\n\nconst MAP_FILTERS = document.querySelector('.map__filters');\nconst MAP_FILTERS_ELEMENTS = MAP_FILTERS.querySelectorAll('.map__filter');\nconst MAP_FILTERS_INPUT = MAP_FILTERS.querySelector('.map__features');\nconst FORM_HEADER = FORM.querySelector('.ad-form-header');\nconst FORM_ELEMENTS = FORM.querySelectorAll('.ad-form__element');\n\nconst toggleDisable = (elements, state) => {\n  elements.forEach(element => {\n    element.disabled = state;\n  })\n};\n\n//добавляем фильтру и эелементам фильтра неактивное состояние\nconst setMapFilterElementsDisabled = () => {\n  MAP_FILTERS.classList.add('ad-form--disabled');\n  toggleDisable(MAP_FILTERS_ELEMENTS, true);\n  MAP_FILTERS_INPUT.setAttribute('disabled', 'disabled');\n};\n\n//добавляем форме заполнения и элементам неактивное состояние\nconst setFormElementsDisabled = () => {\n  FORM.classList.add('ad-form--disabled');\n  FORM_HEADER.setAttribute('disabled', 'disabled');\n  toggleDisable(FORM_ELEMENTS, true);\n};\n\n//активное состояние фильтра и его элементов\nconst setMapFilterElementsActive = () => {\n  MAP_FILTERS.classList.remove('ad-form--disabled');\n  toggleDisable(MAP_FILTERS_ELEMENTS, false);\n  MAP_FILTERS_INPUT.removeAttribute('disabled', 'disabled');\n};\n\n//активное состояние формы заполнения и ее элементов\nconst setFormElementsActive = () => {\n  FORM.classList.remove('ad-form--disabled');\n  FORM_HEADER.removeAttribute('disabled', 'disabled');\n  toggleDisable(FORM_ELEMENTS, false);\n};\n\nconst setFormActive = () => {\n  setMapFilterElementsActive();\n  setFormElementsActive();\n  setCapacitySelectdisabled();\n};\n\nconst initDisabled = () => {\n  setMapFilterElementsDisabled();\n  setFormElementsDisabled();\n  ADDRESS.setAttribute('readonly', '');\n}\n\nexport { setFormActive,  initDisabled };\n","const getData = (onSuccess, onError) => {\n  fetch('https://22.javascript.pages.academy/keksobooking/data')\n    .then((response) => response.json())\n    .then((data) => {\n      onSuccess(data);\n    })\n    .catch(() => {\n      onError('Данные сервера получены не в полном объёме');\n    });\n};\n\nconst sendData = (onSuccessSubmit, onFail, body) => {\n  fetch('https://22.javascript.pages.academy/keksobooking', {\n    method: 'POST',\n    body,\n  })\n    .then((response) => {\n      if (response.ok) {\n        onSuccessSubmit();\n      } else {\n        onFail();\n      }\n    })\n    .catch(() => {\n      onFail();\n    });\n};\n\nexport { getData, sendData };\n"],"sourceRoot":""}